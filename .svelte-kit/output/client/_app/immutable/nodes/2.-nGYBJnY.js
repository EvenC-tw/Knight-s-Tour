import{b as ge,d as Xe,f as A,a as k}from"../chunks/sGujlNqX.js";import{i as Ne}from"../chunks/B_AqWkID.js";import{o as Ze,a as Ke}from"../chunks/CtfEvnOT.js";import{Z as ze,b as er,C as ee,h as N,_ as Z,y as ce,k as e,J as re,z as rr,A as tr,B as $e,D as ue,c as G,ad as ar,F as Ie,a as Se,G as sr,ap as ve,ah as ke,a0 as be,aq as ir,Q as T,ar as xe,a9 as Ae,as as nr,at as lr,ag as or,au as fr,d as ur,av as vr,aw as dr,ab as Te,t as L,ax as cr,ae as br,ac as _r,aj as je,ay as pr,az as hr,aA as mr,aB as gr,aC as $r,q as He,s as De,v as S,w,x as E,f as xr,aD as Cr,N as c,aE as z,aF as Ce,ao as yr,aG as Mr}from"../chunks/DkfcLkkR.js";import{l as qr,e as U,s as P}from"../chunks/BvHBzDWs.js";import{p as ye,i as Y}from"../chunks/D_WX08sC.js";function te(t,a){return a}function wr(t,a,s,r){for(var i=[],l=a.length,f=0;f<l;f++)lr(a[f].e,i,!0);var v=l>0&&i.length===0&&s!==null;if(v){var b=s.parentNode;or(b),b.append(s),r.clear(),O(t,a[0].prev,a[l-1].next)}fr(i,()=>{for(var m=0;m<l;m++){var o=a[m];v||(r.delete(o.k),O(t,o.prev,o.next)),ur(o.e,!v)}})}function ae(t,a,s,r,i,l=null){var f=t,v={flags:a,items:new Map,first:null};{var b=t;f=N?ee(Z(b)):b.appendChild(ze())}N&&ce();var m=null,o=!1,_=re(()=>{var h=s();return Ae(h)?h:h==null?[]:ke(h)});er(()=>{var h=e(_),u=h.length;if(o&&u===0)return;o=u===0;let d=!1;if(N){var C=rr(f)===tr;C!==(u===0)&&(f=$e(),ee(f),ue(!1),d=!0)}if(N){for(var $=null,g,M=0;M<u;M++){if(G.nodeType===8&&G.data===ar){f=G,d=!0,ue(!1);break}var j=h[M],y=r(j,M);g=Re(G,v,$,null,j,y,M,i,a,s),v.items.set(y,g),$=g}u>0&&ee($e())}N||Er(h,v,f,i,a,r,s),l!==null&&(u===0?m?Ie(m):m=Se(()=>l(f)):m!==null&&sr(m,()=>{m=null})),d&&ue(!0),e(_)}),N&&(f=G)}function Er(t,a,s,r,i,l,f){var v=t.length,b=a.items,m=a.first,o=m,_,h=null,u=[],d=[],C,$,g,M;for(M=0;M<v;M+=1){if(C=t[M],$=l(C,M),g=b.get($),g===void 0){var j=o?o.e.nodes_start:s;h=Re(j,a,h,h===null?a.first:h.next,C,$,M,r,i,f),b.set($,h),u=[],d=[],o=h.next;continue}if(Nr(g,C,M),(g.e.f&ve)!==0&&Ie(g.e),g!==o){if(_!==void 0&&_.has(g)){if(u.length<d.length){var y=d[0],x;h=y.prev;var B=u[0],D=u[u.length-1];for(x=0;x<u.length;x+=1)Me(u[x],y,s);for(x=0;x<d.length;x+=1)_.delete(d[x]);O(a,B.prev,D.next),O(a,h,B),O(a,D,y),o=y,h=D,M-=1,u=[],d=[]}else _.delete(g),Me(g,o,s),O(a,g.prev,g.next),O(a,g,h===null?a.first:h.next),O(a,h,g),h=g;continue}for(u=[],d=[];o!==null&&o.k!==$;)(o.e.f&ve)===0&&(_??(_=new Set)).add(o),d.push(o),o=o.next;if(o===null)continue;g=o}u.push(g),h=g,o=g.next}if(o!==null||_!==void 0){for(var V=_===void 0?[]:ke(_);o!==null;)(o.e.f&ve)===0&&V.push(o),o=o.next;var W=V.length;if(W>0){var se=v===0?s:null;wr(a,V,se,b)}}be.first=a.first&&a.first.e,be.last=h&&h.e}function Nr(t,a,s,r){ir(t.v,a),t.i=s}function Re(t,a,s,r,i,l,f,v,b,m){var o=(b&vr)!==0,_=(b&dr)===0,h=o?_?T(i):xe(i):i,u=(b&nr)===0?f:xe(f),d={i:u,v:h,k:l,a:null,e:null,prev:s,next:r};try{return d.e=Se(()=>v(t,h,u,m),N),d.e.prev=s&&s.e,d.e.next=r&&r.e,s===null?a.first=d:(s.next=d,s.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{}}function Me(t,a,s){for(var r=t.next?t.next.e.nodes_start:s,i=a?a.e.nodes_start:s,l=t.e.nodes_start;l!==r;){var f=Te(l);i.before(l),l=f}}function O(t,a,s){a===null?t.first=s:(a.next=s,a.e.next=s&&s.e),s!==null&&(s.prev=a,s.e.prev=a&&a.e)}function Ir(t,a,s=!1,r=!1,i=!1){var l=t,f="";L(()=>{var v=be;if(f===(f=a()??"")){N&&ce();return}if(v.nodes_start!==null&&(cr(v.nodes_start,v.nodes_end),v.nodes_start=v.nodes_end=null),f!==""){if(N){G.data;for(var b=ce(),m=b;b!==null&&(b.nodeType!==8||b.data!=="");)m=b,b=Te(b);if(b===null)throw br(),_r;ge(G,m),l=ee(b);return}var o=f+"";s?o=`<svg>${o}</svg>`:r&&(o=`<math>${o}</math>`);var _=Xe(o);if((s||r)&&(_=Z(_)),ge(Z(_),_.lastChild),s||r)for(;Z(_);)l.before(Z(_));else l.before(_)}})}const qe=[...` 	
\r\f \v\uFEFF`];function Sr(t,a,s){var r=""+t;if(s){for(var i in s)if(s[i])r=r?r+" "+i:i;else if(r.length)for(var l=i.length,f=0;(f=r.indexOf(i,f))>=0;){var v=f+l;(f===0||qe.includes(r[f-1]))&&(v===r.length||qe.includes(r[v]))?r=(f===0?"":r.substring(0,f))+r.substring(v+1):f=v}}return r===""?null:r}function kr(t,a){return t==null?null:String(t)}function Ar(t,a,s,r,i,l){var f=t.__className;if(N||f!==s||f===void 0){var v=Sr(s,r,l);(!N||v!==t.getAttribute("class"))&&(v==null?t.removeAttribute("class"):t.className=v),t.__className=s}else if(l&&i!==l)for(var b in l){var m=!!l[b];(i==null||m!==!!i[b])&&t.classList.toggle(b,m)}return l}function Tr(t,a,s,r){var i=t.__style;if(N||i!==a){var l=kr(a);(!N||l!==t.getAttribute("style"))&&(l==null?t.removeAttribute("style"):t.style.cssText=l),t.__style=a}return r}function Le(t,a,s){if(t.multiple){if(a==null)return;if(!Ae(a))return pr();for(var r of t.options)r.selected=a.includes(K(r));return}for(r of t.options){var i=K(r);if(hr(i,a)){r.selected=!0;return}}(!s||a!==void 0)&&(t.selectedIndex=-1)}function jr(t,a){je(()=>{var s=new MutationObserver(()=>{var r=t.__value;Le(t,r)});return s.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{s.disconnect()}})}function Hr(t,a,s=a){var r=!0;qr(t,"change",i=>{var l=i?"[selected]":":checked",f;if(t.multiple)f=[].map.call(t.querySelectorAll(l),K);else{var v=t.querySelector(l)??t.querySelector("option:not([disabled])");f=v&&K(v)}s(f)}),je(()=>{var i=a();if(Le(t,i,r),r&&i===void 0){var l=t.querySelector(":checked");l!==null&&(i=K(l),s(i))}t.__value=i,r=!1}),jr(t)}function K(t){return"__value"in t?t.__value:t.value}const Dr=Symbol("is custom element"),Rr=Symbol("is html");function Lr(t,a,s,r){var i=Br(t);N&&(i[a]=t.getAttribute(a)),i[a]!==(i[a]=s)&&(s==null?t.removeAttribute(a):typeof s!="string"&&Or(t).includes(a)?t[a]=s:t.setAttribute(a,s))}function Br(t){return t.__attributes??(t.__attributes={[Dr]:t.nodeName.includes("-"),[Rr]:t.namespaceURI===mr})}var we=new Map;function Or(t){var a=we.get(t.nodeName);if(a)return a;we.set(t.nodeName,a=[]);for(var s,r=t,i=Element.prototype;i!==r;){s=$r(r);for(var l in s)s[l].set&&a.push(l);r=gr(r)}return a}var Vr=A('<span class="step-number svelte-s7umiu"> </span>'),Fr=A('<span class="marker knight-marker svelte-s7umiu">♘</span>'),Pr=A('<span class="marker next-move-marker svelte-s7umiu">●</span>'),Gr=A('<div role="button" tabindex="0"><!> <!></div>'),Ur=A('<div class="board-row svelte-s7umiu"></div>'),Yr=A('<div class="board-container svelte-s7umiu"><div class="board svelte-s7umiu"></div></div>');function Wr(t,a){He(a,!1);let s=ye(a,"boardData",8),r=ye(a,"onCellClick",8);Ne();var i=Yr(),l=S(i);ae(l,5,s,te,(f,v,b)=>{var m=Ur();ae(m,5,()=>e(v),te,(o,_,h)=>{var u=Gr();let d;var C=S(u);{var $=y=>{var x=Vr(),B=S(x,!0);w(x),L(()=>P(B,e(_).step)),k(y,x)};Y(C,y=>{e(_).step>0&&y($)})}var g=E(C,2);{var M=y=>{var x=Fr();k(y,x)},j=(y,x)=>{{var B=D=>{var V=Pr();k(D,V)};Y(y,D=>{e(_).isNextMove&&D(B)},x)}};Y(g,y=>{e(_).isCurrent?y(M):y(j,!1)})}w(u),L((y,x)=>{d=Ar(u,1,"cell svelte-s7umiu",null,d,y),Lr(u,"aria-label",x)},[()=>({visited:e(_).visited,current:e(_).isCurrent,"next-move":e(_).isNextMove}),()=>`Cell ${b+1}-${String.fromCharCode(65+h)}${e(_).visited?" visited step "+e(_).step:""}${e(_).isCurrent?" current position":""}${e(_).isNextMove?" possible next move":""}`],re),U("click",u,()=>r()(b,h)),U("keypress",u,()=>r()(b,h)),k(o,u)}),w(m),k(f,m)}),w(l),w(i),L(()=>Tr(l,`--board-columns: ${s().length>0?s()[0].length:8};`)),k(t,i),De()}function Jr(t,a,s){return t>=0&&t<s&&a>=0&&a<s}function de(t,a,s){const r=[],i=[-2,-2,-1,-1,1,1,2,2],l=[-1,1,-2,2,-2,2,-1,1];for(let f=0;f<8;f++){const v=t+i[f],b=a+l[f];Jr(v,b,s)&&r.push([v,b])}return r}function Ee(t){const a=[];for(let s=0;s<t;s++){const r=[];for(let i=0;i<t;i++)r.push({visited:!1,step:0,isCurrent:!1,isNextMove:!1});a.push(r)}return a}var Qr=A("<option> </option>"),Xr=A('<button style="margin-left: 10px; background-color: #dc3545; color: white;" class="svelte-1mj1dqo">結束競賽</button>'),Zr=A('<div class="competition-status svelte-1mj1dqo"><p class="svelte-1mj1dqo"> </p> <p class="svelte-1mj1dqo"> </p></div>'),Kr=A('<div class="hint-box svelte-1mj1dqo"><!></div>'),zr=A('<li class="svelte-1mj1dqo"> </li>'),et=A('<div class="svelte-1mj1dqo"><h3 class="svelte-1mj1dqo">行動序列日誌:</h3> <ul class="svelte-1mj1dqo"></ul></div>'),rt=A('<h1 class="svelte-1mj1dqo">騎士巡遊</h1> <div class="controls svelte-1mj1dqo"><label for="board-size-select" class="svelte-1mj1dqo">選擇棋盤大小 (N x N):</label> <select id="board-size-select" class="svelte-1mj1dqo"></select> <button style="margin-left: 10px;" class="svelte-1mj1dqo"> </button> <button style="margin-left: 10px; background-color: #28a745; color: white;" class="svelte-1mj1dqo">開始競賽模式</button> <!></div> <!> <p class="svelte-1mj1dqo"> </p> <!> <!> <button class="svelte-1mj1dqo">重置挑戰</button> <!>',1);function ot(t,a){He(a,!1);const s=[5,6,7,8,9,10];let r=T(8),i=T(Ee(e(r))),l=null,f=T([]),v=0,b=T(!1),m=T(!1),o=T("棋盤已啟動。參賽者，請指定你的『騎士』初始位置。"),_=T(!1),h=T(""),u=T(!1),d=T(0),C=T(600),$;const g=[6,7,8];function M(n){c(r,n),x(!1)}function j(){c(i,e(i).map((n,p)=>n.map((q,H)=>{let I={...q,isNextMove:!1,isCurrent:!1};return l&&l[0]===p&&l[1]===H&&(I.isCurrent=!0),e(b)&&l&&de(l[0],l[1],e(r)).some(([F,X])=>F===p&&X===H)&&(q.visited||(I.isNextMove=!0)),I})))}function y(n,p){if(!(e(m)&&!e(u))){if(e(m)&&e(u)&&e(C)>0){c(o,`路徑中斷！『騎士』於第 ${e(d)} 關 (${e(r)}x${e(r)}) 卡住。棋盤已重置，請重新嘗試。`),x(!0);return}if(!(e(m)&&e(u)&&e(C)<=0)){if(!e(b))l=[n,p],v=1,z(i,e(i)[n][p].visited=!0),z(i,e(i)[n][p].step=v),e(f).push([n,p,v]),c(b,!0),e(u)&&e(d)>0&&!$&&e(C)>0?(se(),c(o,`競賽開始！第 ${e(d)} 關 (${e(r)}x${e(r)})，計時開始！`)):e(u)||c(o,"『騎士』已配置。參賽者，請規劃其行動序列。");else{if(!l)return;de(l[0],l[1],e(r)).some(([I,R])=>I===n&&R===p)&&!e(i)[n][p].visited?(l=[n,p],v++,z(i,e(i)[n][p].visited=!0),z(i,e(i)[n][p].step=v),e(f).push([n,p,v]),e(u)?c(o,`競賽第 ${e(d)} 關 (${e(r)}x${e(r)}) - 第 ${v} 步。`):c(o,`序列第 ${v} 步：『騎士』抵達座標 (${n+1}, ${String.fromCharCode(65+p)})。`),v===e(r)*e(r)?e(u)?e(d)<g.length?(Ce(d),c(r,g[e(d)-1]),c(o,`恭喜完成第 ${e(d)-1} 關！準備挑戰第 ${e(d)} 關 (${e(r)}x${e(r)})。`),x(!0)):(c(m,!0),W(!0)):(c(m,!0),c(o,"演算完成。參賽者，你的『騎士』已成功遍歷棋盤所有節點。挑戰通過。")):de(n,p,e(r)).some(([F,X])=>!e(i)[F][X].visited)||(c(m,!0),e(u)&&e(C)>0?c(o,`路徑中斷！『騎士』於第 ${e(d)} 關 (${e(r)}x${e(r)}) 卡住。點擊棋盤以重置本關。`):e(u)&&e(C)<=0?(c(o,`時間耗盡且路徑中斷！『騎士』於第 ${e(d)} 關 (${e(r)}x${e(r)}) 挑戰失敗。`),W(!1)):c(o,`路徑分析：『騎士』於第 ${v} 步後已無可用路徑。參賽者，本次挑戰宣告失敗。`))):e(i)[n][p].visited?c(o,`座標 (${n+1}, ${String.fromCharCode(65+p)}) 已部署或曾途經。請選擇其他節點。`):c(o,`指令無效：『騎士』無法移動至座標 (${n+1}, ${String.fromCharCode(65+p)})。請重新規劃路徑。`)}j()}}}function x(n=!1){!n&&e(u)&&W(!1),c(i,Ee(e(r))),l=null,c(f,[]),v=0,c(b,!1),c(m,!1),e(u)&&n||(e(u)&&!n?c(o,"競賽已重置並終止。"):c(o,"棋盤已重置。等待參賽者部署『騎士』。")),j()}function B(n){return n<5?`🔥 ${n}x${n} 棋盤太小，無法完成完整的騎士巡迴。<br><br><b>說明：</b><br>${n}x${n} 棋盤因為格子太少，騎士怎麼走都會有格子沒辦法踩到，就像在小房間裡繞圈圈，永遠無法每個角落都走過一次。<br><br><b>數學小知識：</b><br>數學家證明，只有 1x1、5x5 以上的部分棋盤，才有可能讓騎士走遍每一格。`:n===5?"🔥 <b>5x5 棋盤建議：</b><br><br>每一步都盡量走到「四周出路最少」的格子，這樣比較不會太早卡住。<br><br><b>為什麼？</b><br>想像你在迷宮裡，每次都先走快沒路的地方，這樣比較不會讓其他地方變成死路。<br><br><b>數學小知識：</b><br>5x5 棋盤只能做到「開放巡迴」，也就是最後一步沒辦法回到起點。這是因為棋盤格數是奇數，起點和終點顏色會不同，無法首尾相連。":n===6?"🔥 <b>6x6 棋盤建議：</b><br><br>同樣建議每一步都走到「出路最少」的格子，這樣比較容易走完全部。<br><br><b>說明：</b><br>這種走法叫「Warnsdorff's rule」，意思是每次都優先走快沒路的地方。<br><br><b>數學小知識：</b><br>6x6 棋盤雖然格數是偶數，但因為格子排列的關係，還是無法首尾相連（封閉巡迴），只能做到開放巡迴。":n===7?"🔥 <b>7x7 棋盤建議：</b><br><br>建議還是每一步都走到「出路最少」的格子。<br><br><b>說明：</b><br>這種策略就像先把難走的地方解決，避免後面卡住。<br><br><b>數學小知識：</b><br>7x7 棋盤因為格數是奇數，和 5x5 一樣，無法首尾相連，只能做到開放巡迴。":n>=8?`🔥 <b>${n}x${n} 棋盤建議：</b><br><br>每一步都走到「出路最少」的格子，這樣比較容易完成整個巡迴。<br><br><b>為什麼這樣走？</b><br>就像打掃房間時，會先把最難清的角落處理掉，這樣最後才不會有地方進不去。<br><br><b>數學原理：</b><br>${n}x${n} 棋盤 (例如標準的 8x8 國際象棋棋盤)，數學家證明這種棋盤通常有「封閉巡迴」——也就是你可以從某一格出發，走遍全部格子，最後回到起點。<br>這是因為 ${n}x${n} 棋盤的格數是偶數 (如果 size 是偶數)，且每格都能連到足夠多的其他格子，比較不容易卡住。<br><br><b>趣味補充：</b><br>早在 18 世紀，數學家就對這個問題很有興趣，甚至連歐拉（Euler）都曾研究過。<br>"Warnsdorff's rule"這個方法，就是用來幫助人類和電腦更容易找到一條完整的路徑。<br>如果你想挑戰自己，可以試著讓最後一步回到起點，這就是「封閉巡迴」！`:""}function D(){c(_,!e(_)),e(_)&&c(h,B(e(r)))}function V(){c(u,!0),c(d,1),c(r,g[e(d)-1]),c(C,600),c(o,`競賽模式：第 ${e(d)} 關 (${e(r)}x${e(r)})。請部署騎士。`),$&&clearInterval($),x(!0)}function W(n){c(u,!1),$&&clearInterval($),$=void 0,n?c(o,"競賽完成！恭喜你通過所有關卡！"):e(C)<=0?c(o,"時間到！競賽挑戰失敗。"):c(o,"競賽提前結束。"),c(d,0)}function se(){$&&clearInterval($),!(!e(u)||e(C)<=0)&&($=setInterval(()=>{Ce(C,-1),e(C)<=0&&(clearInterval($),$=void 0,c(m,!0),c(o,`時間耗盡！『騎士』於第 ${e(d)} 關 (${e(r)}x${e(r)}) 挑戰失敗。`),c(u,!1),j())},1e3))}Ze(()=>{j()}),Ke(()=>{$&&clearInterval($)}),Ne();var _e=rt(),ie=E(xr(_e),2),J=E(S(ie),2);L(()=>{e(r),Cr(()=>{e(u)})}),ae(J,5,()=>s,te,(n,p)=>{var q=Qr(),H={},I=S(q);w(q),L(()=>{H!==(H=e(p))&&(q.value=(q.__value=e(p))??""),P(I,`${e(p)??""} x ${e(p)??""}`)}),k(n,q)}),w(J);var Q=E(J,2),Be=S(Q,!0);w(Q);var ne=E(Q,2),Oe=E(ne,2);{var Ve=n=>{var p=Xr();U("click",p,()=>W(!1)),k(n,p)};Y(Oe,n=>{e(u)&&n(Ve)})}w(ie);var pe=E(ie,2);{var Fe=n=>{var p=Zr(),q=S(p),H=S(q);w(q);var I=E(q,2),R=S(I);w(I),w(p),L(F=>{P(H,`競賽模式進行中 - 第 ${e(d)??""} 關 (${e(r)??""}x${e(r)??""})`),P(R,`剩餘時間：${F??""} 分 ${e(C)%60} 秒`)},[()=>Math.floor(e(C)/60)],re),k(n,p)};Y(pe,n=>{e(u)&&n(Fe)})}var le=E(pe,2),Pe=S(le,!0);w(le);var he=E(le,2);{var Ge=n=>{var p=Kr(),q=S(p);Ir(q,()=>e(h)),w(p),k(n,p)};Y(he,n=>{e(_)&&n(Ge)})}var me=E(he,2);Wr(me,{get boardData(){return e(i)},onCellClick:y});var oe=E(me,2),Ue=E(oe,2);{var Ye=n=>{var p=et(),q=E(S(p),2);ae(q,5,()=>e(f),te,(H,I)=>{var R=yr(()=>Mr(e(I),3));let F=()=>e(R)[0],X=()=>e(R)[1],We=()=>e(R)[2];var fe=zr(),Je=S(fe);w(fe),L(Qe=>P(Je,`第 ${We()??""} 步: 部署於 (${F()+1}, ${Qe??""})`),[()=>String.fromCharCode(65+X())],re),k(H,fe)}),w(q),w(p),k(n,p)};Y(Ue,n=>{e(f).length>0&&n(Ye)})}L(()=>{J.disabled=e(u),Q.disabled=e(u),P(Be,e(_)?"隱藏提示":"顯示提示"),ne.disabled=e(u),P(Pe,e(o)),oe.disabled=!e(b)&&!e(m)}),Hr(J,()=>e(r),n=>c(r,n)),U("change",J,n=>M(parseInt(n.target.value))),U("click",Q,D),U("click",ne,V),U("click",oe,()=>x()),k(t,_e),De()}export{ot as component};
